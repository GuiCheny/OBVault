## 知识储备

### 协方差

协方差（Covariance）是统计学中用来衡量两个随机变量之间的线性关系的指标。它可以表明一个变量的变化是否会导致另一个变量的变化，以及这种变化的方向。

##### 计算公式
**公式如下**：
$$\large{cov(x, y)} = \frac{\sum_{i=1}^n (X_i - \overline{X})(Y_i - \overline{Y})}{n}$$

**其中**：

- $n$为样本的总数。
- $X_i$和 $Y_i$分别是变量 $X$和 $Y$的第$i$个样本值。
- $\overline{X}$和$\overline{Y}$为变量 $X$和 $Y$的平均值。

具体来说：

- 如果协方差是正值，意味着当一个变量增大时，另一个变量也会相应增大，二者呈正相关关系。
- 如果协方差是负值，意味着当一个变量增大时，另一个变量会减小，二者呈负相关关系。
- 如果协方差接近零，说明这两个变量之间没有明显的线性关系。

**协方差的大小没有固定的范围，受变量的尺度影响，因此很难直接从协方差的数值判断相关性的强弱**。为了更好地理解两个变量之间的线性关系，通常使用标准化的相关系数（Pearson相关系数）。

### 秩相关系数

秩相关系数(Coefficient of Rank Correlation)，又称等级相关系数，反映的是两个随机变量的的变化趋势方向和强度之间的关联，是将两个随机变量的样本值按数据的大小顺序排列位次，以各要素样本值的位次代替实际数据而求得的一种统计量。常用的等级相关分析方法有**Spearman相关系数**和**Kendall秩相关系数**等。

### 单调性

单调性，monotonicity。

## Pearson相关系数

皮尔逊相关系数（Pearson Correlation Coefficient），也称为皮尔逊积矩相关系数，是一种用于衡量两个变量之间线性相关程度的统计量，其实就是标准化后的协方差，消除了变量尺度的影响。

### 计算公式

**公式如下**：

$$\large\rho_{X,Y}= \frac{cov(X, Y)}{\sigma_X\sigma_Y} = \frac{\sum_{i=1}^n\frac{(X_i - \overline{X})}{\sigma_X}\frac{(Y_i - \overline{Y})}{\sigma_Y} }{n}$$

**其中**：

### 关键点

- **连续性变量：** 皮尔逊相关系数假设两个变量都是连续型的，如身高、体重、血压、温度等数据。
- **正态分布假设：** 皮尔逊相关系数的一个重要前提是数据满足正态分布或接近正态分布。
- **线性关系：** 皮尔逊相关系数用于衡量两个变量之间的线性关系，而不是其他类型的关系（例如非线性、单调等）。

### 数学性质

###### 1. 对称性

$$\large\rho_{X,Y}=\rho_{Y,X}$$

###### 2. 位移不变性

令$X'=X+x_0,Y'=Y+y_0$, $x_0$、$y_0$均为常数，有：

$$\large\rho_{X',Y'}=\rho_{X,Y}$$

因为，

$$\overline{X' - \mu_{x'}}=E[(X+x_0)-(\mu_X+x_0)]=\overline{X - \mu_{X}}$$

$$\overline{Y' - \mu_{y'}}=E[(Y+y_0)-(\mu_Y+y_0)]=\overline{Y - \mu_{Y}}$$

###### 3. 尺度不变性

令$X'=k_xX,X'=k_yY$, $k_x$、$k_y$均为常数，有：

$$\large\rho_{X',Y'}=\rho_{X,Y}$$

### 相关系数评价

| 相关性 | 负        | 正      |
| ------ | --------- | ------- |
| 无相关 | -0.09~0   | 0~0.09  |
| 弱相关 | -0.3~-0.1 | 0.1~0.3 |
| 中相关 | -0.5~-0.3 | 0.3~0.5 |
| 强相关 | -1~-0.5   | 0.5~1.0 |

### 假设检验

### 注意事项

- 皮尔逊相关系数只是用于衡量线性相关关系的，在数据的分布不清楚的情况下，直接比较皮尔逊相关系数不能说明任何问题，我们==必须画出散点图进行比较==。
- ==离群点==对于皮尔逊相关系数的影响很大，可以根据情况思考是否要将其

## Spearman相关系数

斯皮尔曼相关系数(Spearman correlation):秩相关系数，也称为**等级变量之间的皮尔逊相关系数**，因为它可以看作为皮尔逊相关的非参数版本(nonparametric version)。

### 计算公式

**公式如下**：

$$\Large \rho \normalsize =\frac{\frac{1}{n}\sum_{i=1}^n\left(R(x_i)-\overline{R(x)}\right)\cdot\left(R(y_i)-\overline{R(y)}\right)}{\sqrt{\left(\frac{1}{n}\sum_{i=1}^n \left(R(x_i)- R(x)\right)^2\right)\cdot\left(\frac{1}{n}\sum_{i=1}^n \left(R(y_i)- R(y)\right)^2\right)}}$$

**其中**：


简易版本，

$\rho=1-\frac{6\sum d_i^2}{n(n^2 - 1)}$

**各符号含义**

- $d_i$是第对数据点在两个变量中的秩差。
- $n$是数据点的总数。

### 适用场景

- 数据展现的是非线性关系，或者不是正态分布的。
- 至少有一方数据是序数类型（ordinal）而非数值类型。
- 数据中有明显的异常值（outliers）。

### 假设检验

## Kendall相关系数

肯德尔相关系数(Kendall’s tau coefficien):秩相关系数，通常也称为Kendall的tau系数，是用于测量两个测量量之间的序数关联的统计量。

### 基本假设

1. **变量数据是有序的(ordinal)或者是连续的(continuous)**。 有序尺度(Ordinal scales )的数据通常用于用数值的方式来衡量非数值的概念。
2. **两个变量的数据之间应该遵循单调关系(monotonic relationship)**。 当然，这个单调关系是一个统计意义上的，而非严格的单调。

### 计算公式

##### 1. Tau-a 公式

**Tau-a** 是肯德尔相关系数的一种形式，用于计算两个变量的秩次之间的相关性，**适用于没有并列数据的情况**。

**公式如下**：

$$\Large\tau_a\normalsize=\frac{P - Q}{2n(n - 1)}$$

**其中**：

- $P$是一致对数（concordant pairs）的数量，即两个变量的秩次对在两个变量中都相同的顺序。
- $Q$是不一致对数（discordantpairs）的数量，即两个变量的秩次对在一个变量中顺序相同，在另一个变量中顺序相反。
- $n$是样本量。

##### 2. Tau-b 公式

**Tau-b** 是另一种肯德尔相关系数的形式，**适用于处理并列数据（即秩次相同的情况）**，比 Tau-a 更常用。

**公式如下：**

$$\Large\tau_b\normalsize=\frac{P - Q}{\sqrt{\left(P+Q+T_x)(P+Q+Ty\right)}}$$

**其中：**

- $P$是一致对数的数量。
- $Q$是不一致对数的数量。
- $T_x$是在第一个变量中并列的对数，即第一个变量中秩次相同的对数。
- $T_y$​是在第二个变量中并列的对数，即第二个变量中秩次相同的对数。

## 三大统计分析方法比较

皮尔逊相关是关于两个随机变量之间的线性关系强度的统计度量(statistical measure)，而斯皮尔曼相关考察的是两者单调关系（monotonic relationship）的强度，通俗地说就是两者在变大或变小的趋势上多大程度上保持步调一致，哪怕没有保持比例关系。计算皮尔逊相关系数时使用的是数据样本值本身，而计算斯皮尔曼相关系数使用的是数据样本排位位次值（有时候数据本身就是位次值，有时候数据本身不是位次值，则在计算斯皮尔曼相关系数之前要先计算位次值）。

不同的是，斯皮尔曼相关是基于秩差（比如说，小明在班级中的历史成绩排名为10，英语成绩排名为4，那么在这个班级的学生的历史成绩和英语成绩的斯皮尔曼相关分析中，小明的成绩的贡献就是(10-4=6) ）来进行相关关系的评估；而肯德尔相关则是基于样本数据对之间的关系来进行相关系数的强弱的分析，数据对可以分为一致对(Concordant)和分歧对(Discordant)。



## 参考资料

1. <https://blog.csdn.net/weixin_42128414/article/details/131230816>
2. <https://blog.csdn.net/limiyudianzi/article/details/103437093>
3. <https://blog.csdn.net/chenxy_bwave/article/details/121427036>
4. 